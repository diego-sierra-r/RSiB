---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%", 
  dev = "svg"
)


```

# RSiBCOL

<!-- badges: start -->
[![R-CMD-check](https://github.com/diego-sierra-r/RSiB/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/diego-sierra-r/RSiB/actions/workflows/R-CMD-check.yaml)
<!-- badges: end -->

The goal of `RSiBCOL` is to create queries and get data from SiB databases, This packages helps you to pull data from GIBF API like *location*, *coordinates*, *sex*, *dates* and relevant information related with taxonomy for any specie record in Colombia using R syntax. Furthermore, `RSiBCOL` can create basic maps to represent records on a geographic context and those maps can be customized easily using `tmap` if you need specific changes. 

## Installation

You can install the development version of RSiBCOL from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("diego-sierra-r/RSiB")
```

## Example

Imagine you need to get all  *Caiman cocodrilus* records for a specific year in Colombia. With `RSiBCOL` the first thing you have to do to accomplish this task is go to [GBIF Backbone Taxonomy](https://www.gbif.org/species/search) and find the GBIF taxon ID. In this case is  8953936.

Then, it's possible to use get_specie_records() function to find all records for *Caiman cocodrilus* registered in 2020.

```{r, echo=FALSE}
devtools::load_all()
```

```{r}
library("RSiBCOL")
```

```{r example, eval=FALSE}
get_specie_records(year = 2020, all.records = TRUE,specieKey = 8953936)
```

If you want just some records you can use limit and offset arguments.

```{r}
get_specie_records(limit = 5,
                   offset = 1,
                   year = 2020, 
                   all.records = FALSE,
                   specieKey = 8953936)
# when all.records = TRUE its overides limit and offset arguments

```


This function returns a data.frame with more than 100 columns that you can use for your own purposes, but if you just need you some basic taxonomic information, coordinates and dates relevant_vars() keep just 10 columns.

```{r}
colnames(relevant_vars(caiman_crocodilus))
```

Other handy functions to clean data generated by get_specie_records() are slicer() and filter_if_match().

```{r, eval=FALSE}
slicer(caiman_crocodilus,1,10)

filter_if_match(caiman_crocodilus,
                column = "scientificName",
                terms = "fuscus")
```

Finally, `RSiBCOL` can generate some basic plots to represent records over a map. This objects can be customized an enhanced using `tmap` packaged according to specific needs.

```{r}
# whole map
map_colombia(caiman_crocodilus,column = "scientificName")
```


```{r}
# Department map
map_depto(df = caiman_crocodilus,
          depto = "La Guajira",
          legend.show = F,
          column = "species")
```

```{r}
map_mun(caiman_crocodilus,
        mun = "Barrancas",
        column = "species",
        legend.show = FALSE)

```
